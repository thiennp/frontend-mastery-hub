<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web APIs & Fetch Examples - Level 4</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 30px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #fafafa;
        }
        
        .section h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .demo-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .demo-button:active {
            transform: translateY(0);
        }
        
        .result {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            background: #fed7d7;
            color: #c53030;
            border: 1px solid #feb2b2;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success {
            background: #c6f6d5;
            color: #2f855a;
            border: 1px solid #9ae6b4;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            margin-top: 0;
            color: #2d3748;
        }
        
        .api-list {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .api-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .api-name {
            font-weight: bold;
            color: #495057;
        }
        
        .api-status {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .api-status.available {
            background: #d4edda;
            color: #155724;
        }
        
        .api-status.unavailable {
            background: #f8d7da;
            color: #721c24;
        }
        
        .api-status.partial {
            background: #fff3cd;
            color: #856404;
        }
        
        .fetch-example {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .fetch-example h4 {
            margin: 0 0 10px 0;
            color: #1976d2;
        }
        
        .request-info {
            background: #f3e5f5;
            border: 1px solid #ce93d8;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .request-info h5 {
            margin: 0 0 5px 0;
            color: #7b1fa2;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .tip {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Web APIs & Fetch Examples</h1>
            <p>Level 4 - Frontend Mastery Hub</p>
        </div>
        
        <div class="content">
            <!-- Web APIs Overview Section -->
            <div class="section">
                <h2>1. Web APIs Overview</h2>
                <p>Web APIs provide powerful functionality to web applications, enabling them to interact with the browser, device, and external services.</p>
                
                <div class="api-list">
                    <h3>Common Web APIs</h3>
                    <div class="api-item">
                        <span class="api-name">Fetch API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Geolocation API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Notification API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Storage API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Web Workers API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Service Workers API</span>
                        <span class="api-status partial">Partial</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">WebRTC API</span>
                        <span class="api-status available">Available</span>
                    </div>
                    <div class="api-item">
                        <span class="api-name">Web Audio API</span>
                        <span class="api-status available">Available</span>
                    </div>
                </div>
                
                <button class="demo-button" onclick="demoWebAPIsOverview()">Demo Web APIs Overview</button>
                <div id="overview-result" class="result"></div>
            </div>
            
            <!-- Basic Fetch API Section -->
            <div class="section">
                <h2>2. Basic Fetch API</h2>
                <p>The Fetch API provides a modern, promise-based way to make HTTP requests.</p>
                
                <div class="code-block">
// Basic Fetch API usage
async function fetchData() {
    try {
        const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('Error fetching data:', error);
        throw error;
    }
}

// Using the function
fetchData()
    .then(data => console.log('Data:', data))
    .catch(error => console.error('Error:', error));
                </div>
                
                <button class="demo-button" onclick="demoBasicFetch()">Demo Basic Fetch</button>
                <div id="basic-fetch-result" class="result"></div>
            </div>
            
            <!-- Fetch with Different HTTP Methods Section -->
            <div class="section">
                <h2>3. Fetch with Different HTTP Methods</h2>
                <p>Using Fetch API with various HTTP methods (GET, POST, PUT, DELETE).</p>
                
                <div class="code-block">
// GET request
async function getData(url) {
    const response = await fetch(url);
    return response.json();
}

// POST request
async function postData(url, data) {
    const response = await fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    });
    return response.json();
}

// PUT request
async function putData(url, data) {
    const response = await fetch(url, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    });
    return response.json();
}

// DELETE request
async function deleteData(url) {
    const response = await fetch(url, {
        method: 'DELETE'
    });
    return response.ok;
}

// Using the functions
const postData = {
    title: 'New Post',
    body: 'This is a new post',
    userId: 1
};

postData('https://jsonplaceholder.typicode.com/posts', postData)
    .then(data => console.log('Created post:', data))
    .catch(error => console.error('Error:', error));
                </div>
                
                <button class="demo-button" onclick="demoFetchMethods()">Demo Fetch Methods</button>
                <div id="fetch-methods-result" class="result"></div>
            </div>
            
            <!-- Fetch with Headers and Options Section -->
            <div class="section">
                <h2>4. Fetch with Headers and Options</h2>
                <p>Customizing Fetch requests with headers, authentication, and other options.</p>
                
                <div class="code-block">
// Fetch with custom headers
async function fetchWithHeaders(url, token) {
    const response = await fetch(url, {
        method: 'GET',
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json',
            'X-Custom-Header': 'Custom Value',
            'Accept': 'application/json'
        }
    });
    
    if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
}

// Fetch with timeout
async function fetchWithTimeout(url, timeout = 5000) {
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), timeout);
    
    try {
        const response = await fetch(url, {
            signal: controller.signal
        });
        clearTimeout(timeoutId);
        return response.json();
    } catch (error) {
        clearTimeout(timeoutId);
        if (error.name === 'AbortError') {
            throw new Error('Request timeout');
        }
        throw error;
    }
}

// Fetch with credentials
async function fetchWithCredentials(url) {
    const response = await fetch(url, {
        method: 'GET',
        credentials: 'include', // Include cookies
        mode: 'cors', // CORS mode
        cache: 'no-cache' // Don't use cache
    });
    
    return response.json();
}
                </div>
                
                <button class="demo-button" onclick="demoFetchHeaders()">Demo Fetch Headers</button>
                <div id="fetch-headers-result" class="result"></div>
            </div>
            
            <!-- Error Handling Section -->
            <div class="section">
                <h2>5. Error Handling with Fetch</h2>
                <p>Proper error handling strategies for Fetch API requests.</p>
                
                <div class="code-block">
// Comprehensive error handling
async function robustFetch(url, options = {}) {
    try {
        const response = await fetch(url, options);
        
        // Check if response is ok
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        // Check content type
        const contentType = response.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
            throw new Error('Response is not JSON');
        }
        
        const data = await response.json();
        return data;
        
    } catch (error) {
        // Handle different types of errors
        if (error.name === 'TypeError') {
            throw new Error('Network error - check your connection');
        } else if (error.name === 'AbortError') {
            throw new Error('Request was aborted');
        } else {
            throw error;
        }
    }
}

// Using the robust fetch function
robustFetch('https://jsonplaceholder.typicode.com/posts/1')
    .then(data => console.log('Success:', data))
    .catch(error => console.error('Error:', error.message));
                </div>
                
                <button class="demo-button" onclick="demoErrorHandling()">Demo Error Handling</button>
                <div id="error-handling-result" class="result"></div>
            </div>
            
            <!-- Geolocation API Section -->
            <div class="section">
                <h2>6. Geolocation API</h2>
                <p>Using the Geolocation API to get the user's current position.</p>
                
                <div class="code-block">
// Geolocation API usage
function getCurrentPosition() {
    return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
            reject(new Error('Geolocation is not supported by this browser'));
            return;
        }
        
        navigator.geolocation.getCurrentPosition(
            (position) => {
                resolve({
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy,
                    timestamp: position.timestamp
                });
            },
            (error) => {
                reject(new Error(`Geolocation error: ${error.message}`));
            },
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 60000
            }
        );
    });
}

// Watch position changes
function watchPosition(callback) {
    if (!navigator.geolocation) {
        throw new Error('Geolocation is not supported');
    }
    
    return navigator.geolocation.watchPosition(
        (position) => {
            callback({
                latitude: position.coords.latitude,
                longitude: position.coords.longitude,
                accuracy: position.coords.accuracy,
                timestamp: position.timestamp
            });
        },
        (error) => {
            console.error('Geolocation error:', error);
        },
        {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 60000
        }
    );
}
                </div>
                
                <button class="demo-button" onclick="demoGeolocation()">Demo Geolocation</button>
                <div id="geolocation-result" class="result"></div>
            </div>
            
            <!-- Storage API Section -->
            <div class="section">
                <h2>7. Storage API</h2>
                <p>Using localStorage and sessionStorage for client-side data persistence.</p>
                
                <div class="code-block">
// Storage API utilities
class StorageManager {
    constructor(storage = localStorage) {
        this.storage = storage;
    }
    
    set(key, value) {
        try {
            this.storage.setItem(key, JSON.stringify(value));
            return true;
        } catch (error) {
            console.error('Error setting storage:', error);
            return false;
        }
    }
    
    get(key, defaultValue = null) {
        try {
            const item = this.storage.getItem(key);
            return item ? JSON.parse(item) : defaultValue;
        } catch (error) {
            console.error('Error getting storage:', error);
            return defaultValue;
        }
    }
    
    remove(key) {
        try {
            this.storage.removeItem(key);
            return true;
        } catch (error) {
            console.error('Error removing storage:', error);
            return false;
        }
    }
    
    clear() {
        try {
            this.storage.clear();
            return true;
        } catch (error) {
            console.error('Error clearing storage:', error);
            return false;
        }
    }
    
    keys() {
        return Object.keys(this.storage);
    }
    
    size() {
        return this.storage.length;
    }
}

// Usage
const localStore = new StorageManager(localStorage);
const sessionStore = new StorageManager(sessionStorage);

// Store data
localStore.set('user', { name: 'John', email: 'john@example.com' });
sessionStore.set('session', { id: '123', timestamp: Date.now() });

// Retrieve data
const user = localStore.get('user');
const session = sessionStore.get('session');
                </div>
                
                <button class="demo-button" onclick="demoStorageAPI()">Demo Storage API</button>
                <div id="storage-result" class="result"></div>
            </div>
            
            <!-- Notification API Section -->
            <div class="section">
                <h2>8. Notification API</h2>
                <p>Using the Notification API to display system notifications.</p>
                
                <div class="code-block">
// Notification API usage
class NotificationManager {
    constructor() {
        this.permission = Notification.permission;
    }
    
    async requestPermission() {
        if (!('Notification' in window)) {
            throw new Error('This browser does not support notifications');
        }
        
        if (this.permission === 'default') {
            this.permission = await Notification.requestPermission();
        }
        
        return this.permission === 'granted';
    }
    
    show(title, options = {}) {
        if (this.permission !== 'granted') {
            throw new Error('Notification permission not granted');
        }
        
        const notification = new Notification(title, {
            body: options.body || '',
            icon: options.icon || '/favicon.ico',
            badge: options.badge || '/badge.png',
            tag: options.tag || 'default',
            requireInteraction: options.requireInteraction || false,
            silent: options.silent || false,
            ...options
        });
        
        // Auto-close after 5 seconds
        setTimeout(() => {
            notification.close();
        }, 5000);
        
        return notification;
    }
    
    showScheduled(title, options = {}, delay = 0) {
        setTimeout(() => {
            this.show(title, options);
        }, delay);
    }
}

// Usage
const notificationManager = new NotificationManager();

// Request permission and show notification
notificationManager.requestPermission()
    .then(granted => {
        if (granted) {
            notificationManager.show('Hello!', {
                body: 'This is a test notification',
                icon: '/icon.png'
            });
        }
    });
                </div>
                
                <button class="demo-button" onclick="demoNotificationAPI()">Demo Notification API</button>
                <div id="notification-result" class="result"></div>
            </div>
            
            <!-- Web Workers API Section -->
            <div class="section">
                <h2>9. Web Workers API</h2>
                <p>Using Web Workers to run JavaScript in background threads.</p>
                
                <div class="code-block">
// Web Worker usage
class WorkerManager {
    constructor() {
        this.workers = new Map();
    }
    
    createWorker(script) {
        const worker = new Worker(script);
        this.workers.set(script, worker);
        return worker;
    }
    
    postMessage(script, message) {
        const worker = this.workers.get(script);
        if (worker) {
            worker.postMessage(message);
        }
    }
    
    terminate(script) {
        const worker = this.workers.get(script);
        if (worker) {
            worker.terminate();
            this.workers.delete(script);
        }
    }
    
    terminateAll() {
        this.workers.forEach(worker => worker.terminate());
        this.workers.clear();
    }
}

// Usage
const workerManager = new WorkerManager();

// Create a worker (you would need to create worker.js)
// const worker = workerManager.createWorker('worker.js');

// worker.onmessage = (event) => {
//     console.log('Message from worker:', event.data);
// };

// workerManager.postMessage('worker.js', { type: 'start', data: 1000000 });
                </div>
                
                <button class="demo-button" onclick="demoWebWorkers()">Demo Web Workers</button>
                <div id="webworkers-result" class="result"></div>
            </div>
            
            <!-- Real-world Example Section -->
            <div class="section">
                <h2>10. Real-world Example: Weather App</h2>
                <p>A practical example combining multiple Web APIs in a weather application.</p>
                
                <div class="code-block">
// Weather App using multiple Web APIs
class WeatherApp {
    constructor(apiKey) {
        this.apiKey = apiKey;
        this.storage = new StorageManager(localStorage);
        this.notificationManager = new NotificationManager();
        this.currentLocation = null;
    }
    
    async init() {
        try {
            // Request notification permission
            await this.notificationManager.requestPermission();
            
            // Try to get cached location
            this.currentLocation = this.storage.get('lastLocation');
            
            if (!this.currentLocation) {
                // Get current location
                this.currentLocation = await this.getCurrentLocation();
                this.storage.set('lastLocation', this.currentLocation);
            }
            
            // Load weather data
            const weatherData = await this.getWeatherData(this.currentLocation);
            
            // Show notification if weather is severe
            if (weatherData.severe) {
                this.notificationManager.show('Weather Alert', {
                    body: `Severe weather detected: ${weatherData.description}`,
                    requireInteraction: true
                });
            }
            
            return weatherData;
        } catch (error) {
            console.error('Error initializing weather app:', error);
            throw error;
        }
    }
    
    async getCurrentLocation() {
        return new Promise((resolve, reject) => {
            if (!navigator.geolocation) {
                reject(new Error('Geolocation not supported'));
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    resolve({
                        lat: position.coords.latitude,
                        lon: position.coords.longitude,
                        accuracy: position.coords.accuracy
                    });
                },
                (error) => {
                    reject(new Error(`Geolocation error: ${error.message}`));
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                }
            );
        });
    }
    
    async getWeatherData(location) {
        try {
            const response = await fetch(
                `https://api.openweathermap.org/data/2.5/weather?lat=${location.lat}&lon=${location.lon}&appid=${this.apiKey}&units=metric`
            );
            
            if (!response.ok) {
                throw new Error(`Weather API error: ${response.status}`);
            }
            
            const data = await response.json();
            
            // Check for severe weather
            const severe = data.weather.some(w => 
                w.main === 'Thunderstorm' || w.main === 'Tornado'
            );
            
            return {
                ...data,
                severe,
                timestamp: Date.now()
            };
        } catch (error) {
            console.error('Error fetching weather data:', error);
            throw error;
        }
    }
}

// Usage
const weatherApp = new WeatherApp('your-api-key');
weatherApp.init()
    .then(data => console.log('Weather data:', data))
    .catch(error => console.error('Error:', error));
                </div>
                
                <button class="demo-button" onclick="demoWeatherApp()">Demo Weather App</button>
                <div id="weather-app-result" class="result"></div>
            </div>
        </div>
    </div>

    <script>
        // Utility function to display results
        function displayResult(elementId, content, type = 'info') {
            const element = document.getElementById(elementId);
            element.textContent = content;
            element.className = `result ${type}`;
        }
        
        // Web APIs Overview demo
        function demoWebAPIsOverview() {
            displayResult('overview-result', 'Loading...', 'info');
            
            let output = 'Web APIs Availability Check:\n\n';
            
            const apis = [
                { name: 'Fetch API', check: () => typeof fetch !== 'undefined' },
                { name: 'Geolocation API', check: () => 'geolocation' in navigator },
                { name: 'Notification API', check: () => 'Notification' in window },
                { name: 'Storage API', check: () => 'localStorage' in window },
                { name: 'Web Workers API', check: () => typeof Worker !== 'undefined' },
                { name: 'Service Workers API', check: () => 'serviceWorker' in navigator },
                { name: 'WebRTC API', check: () => 'RTCPeerConnection' in window },
                { name: 'Web Audio API', check: () => 'AudioContext' in window || 'webkitAudioContext' in window }
            ];
            
            apis.forEach(api => {
                const available = api.check();
                output += `${api.name}: ${available ? '✅ Available' : '❌ Not Available'}\n`;
            });
            
            output += `\nTotal: ${apis.filter(api => api.check()).length}/${apis.length} APIs available`;
            
            displayResult('overview-result', output, 'success');
        }
        
        // Basic Fetch demo
        async function demoBasicFetch() {
            displayResult('basic-fetch-result', 'Loading...', 'info');
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                displayResult('basic-fetch-result', 
                    `Successfully fetched data:\n${JSON.stringify(data, null, 2)}`, 'success');
            } catch (error) {
                displayResult('basic-fetch-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // Fetch Methods demo
        async function demoFetchMethods() {
            displayResult('fetch-methods-result', 'Loading...', 'info');
            
            let output = 'Testing different HTTP methods:\n\n';
            
            try {
                // GET request
                const getResponse = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                const getData = await getResponse.json();
                output += `GET Request: ${JSON.stringify(getData, null, 2)}\n\n`;
                
                // POST request
                const postData = {
                    title: 'New Post',
                    body: 'This is a new post',
                    userId: 1
                };
                
                const postResponse = await fetch('https://jsonplaceholder.typicode.com/posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(postData)
                });
                
                const postResult = await postResponse.json();
                output += `POST Request: ${JSON.stringify(postResult, null, 2)}\n\n`;
                
                // PUT request
                const putData = {
                    id: 1,
                    title: 'Updated Post',
                    body: 'This post has been updated',
                    userId: 1
                };
                
                const putResponse = await fetch('https://jsonplaceholder.typicode.com/posts/1', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(putData)
                });
                
                const putResult = await putResponse.json();
                output += `PUT Request: ${JSON.stringify(putResult, null, 2)}\n\n`;
                
                // DELETE request
                const deleteResponse = await fetch('https://jsonplaceholder.typicode.com/posts/1', {
                    method: 'DELETE'
                });
                
                output += `DELETE Request: ${deleteResponse.ok ? 'Success' : 'Failed'}\n`;
                
                displayResult('fetch-methods-result', output, 'success');
            } catch (error) {
                displayResult('fetch-methods-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // Fetch Headers demo
        async function demoFetchHeaders() {
            displayResult('fetch-headers-result', 'Loading...', 'info');
            
            let output = 'Testing Fetch with custom headers:\n\n';
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Custom-Header': 'Custom Value',
                        'Accept': 'application/json'
                    }
                });
                
                output += `Response Status: ${response.status}\n`;
                output += `Response Headers:\n`;
                
                response.headers.forEach((value, key) => {
                    output += `  ${key}: ${value}\n`;
                });
                
                const data = await response.json();
                output += `\nResponse Data: ${JSON.stringify(data, null, 2)}`;
                
                displayResult('fetch-headers-result', output, 'success');
            } catch (error) {
                displayResult('fetch-headers-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // Error Handling demo
        async function demoErrorHandling() {
            displayResult('error-handling-result', 'Loading...', 'info');
            
            let output = 'Testing error handling strategies:\n\n';
            
            // Test with valid URL
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                output += `✅ Valid URL: ${JSON.stringify(data, null, 2)}\n\n`;
            } catch (error) {
                output += `❌ Valid URL Error: ${error.message}\n\n`;
            }
            
            // Test with invalid URL
            try {
                const response = await fetch('https://invalid-url-that-does-not-exist.com/api');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                output += `✅ Invalid URL: ${JSON.stringify(data, null, 2)}\n\n`;
            } catch (error) {
                output += `❌ Invalid URL Error: ${error.message}\n\n`;
            }
            
            // Test with timeout
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 1000);
                
                const response = await fetch('https://httpbin.org/delay/2', {
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                const data = await response.json();
                output += `✅ Timeout Test: ${JSON.stringify(data, null, 2)}\n\n`;
            } catch (error) {
                if (error.name === 'AbortError') {
                    output += `❌ Timeout Test: Request timeout (expected)\n\n`;
                } else {
                    output += `❌ Timeout Test Error: ${error.message}\n\n`;
                }
            }
            
            output += 'Error handling strategies tested successfully!';
            displayResult('error-handling-result', output, 'success');
        }
        
        // Geolocation demo
        function demoGeolocation() {
            displayResult('geolocation-result', 'Loading...', 'info');
            
            if (!navigator.geolocation) {
                displayResult('geolocation-result', 'Geolocation is not supported by this browser', 'error');
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const location = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude,
                        accuracy: position.coords.accuracy,
                        timestamp: new Date(position.timestamp).toLocaleString()
                    };
                    
                    displayResult('geolocation-result', 
                        `Location retrieved successfully:\n${JSON.stringify(location, null, 2)}`, 'success');
                },
                (error) => {
                    let errorMessage = 'Geolocation error: ';
                    switch (error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage += 'Permission denied';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage += 'Position unavailable';
                            break;
                        case error.TIMEOUT:
                            errorMessage += 'Request timeout';
                            break;
                        default:
                            errorMessage += error.message;
                    }
                    
                    displayResult('geolocation-result', errorMessage, 'error');
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                }
            );
        }
        
        // Storage API demo
        function demoStorageAPI() {
            displayResult('storage-result', 'Loading...', 'info');
            
            class StorageManager {
                constructor(storage = localStorage) {
                    this.storage = storage;
                }
                
                set(key, value) {
                    try {
                        this.storage.setItem(key, JSON.stringify(value));
                        return true;
                    } catch (error) {
                        console.error('Error setting storage:', error);
                        return false;
                    }
                }
                
                get(key, defaultValue = null) {
                    try {
                        const item = this.storage.getItem(key);
                        return item ? JSON.parse(item) : defaultValue;
                    } catch (error) {
                        console.error('Error getting storage:', error);
                        return defaultValue;
                    }
                }
                
                remove(key) {
                    try {
                        this.storage.removeItem(key);
                        return true;
                    } catch (error) {
                        console.error('Error removing storage:', error);
                        return false;
                    }
                }
                
                clear() {
                    try {
                        this.storage.clear();
                        return true;
                    } catch (error) {
                        console.error('Error clearing storage:', error);
                        return false;
                    }
                }
                
                keys() {
                    return Object.keys(this.storage);
                }
                
                size() {
                    return this.storage.length;
                }
            }
            
            const localStore = new StorageManager(localStorage);
            const sessionStore = new StorageManager(sessionStorage);
            
            let output = 'Storage API Demo:\n\n';
            
            // Test localStorage
            output += 'Testing localStorage:\n';
            localStore.set('user', { name: 'John', email: 'john@example.com' });
            localStore.set('settings', { theme: 'dark', language: 'en' });
            
            const user = localStore.get('user');
            const settings = localStore.get('settings');
            
            output += `User: ${JSON.stringify(user, null, 2)}\n`;
            output += `Settings: ${JSON.stringify(settings, null, 2)}\n`;
            output += `Storage size: ${localStore.size()} items\n\n`;
            
            // Test sessionStorage
            output += 'Testing sessionStorage:\n';
            sessionStore.set('session', { id: '123', timestamp: Date.now() });
            
            const session = sessionStore.get('session');
            output += `Session: ${JSON.stringify(session, null, 2)}\n`;
            output += `Session storage size: ${sessionStore.size()} items\n\n`;
            
            output += 'Storage API demo completed successfully!';
            displayResult('storage-result', output, 'success');
        }
        
        // Notification API demo
        function demoNotificationAPI() {
            displayResult('notification-result', 'Loading...', 'info');
            
            if (!('Notification' in window)) {
                displayResult('notification-result', 'This browser does not support notifications', 'error');
                return;
            }
            
            let output = 'Notification API Demo:\n\n';
            output += `Current permission: ${Notification.permission}\n\n`;
            
            if (Notification.permission === 'default') {
                output += 'Requesting notification permission...\n';
                
                Notification.requestPermission().then(permission => {
                    output += `Permission granted: ${permission === 'granted'}\n\n`;
                    
                    if (permission === 'granted') {
                        const notification = new Notification('Hello!', {
                            body: 'This is a test notification from the demo',
                            icon: '/favicon.ico',
                            tag: 'demo-notification'
                        });
                        
                        output += 'Notification sent successfully!\n';
                        
                        // Auto-close after 3 seconds
                        setTimeout(() => {
                            notification.close();
                        }, 3000);
                    } else {
                        output += 'Notification permission denied\n';
                    }
                    
                    displayResult('notification-result', output, 'success');
                });
            } else if (Notification.permission === 'granted') {
                const notification = new Notification('Hello!', {
                    body: 'This is a test notification from the demo',
                    icon: '/favicon.ico',
                    tag: 'demo-notification'
                });
                
                output += 'Notification sent successfully!\n';
                
                // Auto-close after 3 seconds
                setTimeout(() => {
                    notification.close();
                }, 3000);
                
                displayResult('notification-result', output, 'success');
            } else {
                output += 'Notification permission denied. Please enable notifications in your browser settings.\n';
                displayResult('notification-result', output, 'error');
            }
        }
        
        // Web Workers demo
        function demoWebWorkers() {
            displayResult('webworkers-result', 'Loading...', 'info');
            
            if (typeof Worker === 'undefined') {
                displayResult('webworkers-result', 'Web Workers are not supported in this browser', 'error');
                return;
            }
            
            let output = 'Web Workers API Demo:\n\n';
            output += 'Web Workers are supported in this browser!\n\n';
            
            // Create a simple worker using a data URL
            const workerCode = `
                self.onmessage = function(e) {
                    const { type, data } = e.data;
                    
                    if (type === 'calculate') {
                        // Simulate heavy computation
                        let result = 0;
                        for (let i = 0; i < data; i++) {
                            result += Math.sqrt(i);
                        }
                        
                        self.postMessage({
                            type: 'result',
                            data: result,
                            timestamp: Date.now()
                        });
                    }
                };
            `;
            
            const blob = new Blob([workerCode], { type: 'application/javascript' });
            const workerUrl = URL.createObjectURL(blob);
            const worker = new Worker(workerUrl);
            
            output += 'Created Web Worker\n';
            output += 'Sending calculation task...\n';
            
            worker.onmessage = function(e) {
                const { type, data, timestamp } = e.data;
                
                if (type === 'result') {
                    output += `Calculation completed: ${data.toFixed(2)}\n`;
                    output += `Time taken: ${Date.now() - timestamp}ms\n\n`;
                    output += 'Web Worker demo completed successfully!';
                    
                    worker.terminate();
                    URL.revokeObjectURL(workerUrl);
                    
                    displayResult('webworkers-result', output, 'success');
                }
            };
            
            worker.onerror = function(error) {
                output += `Worker error: ${error.message}\n`;
                displayResult('webworkers-result', output, 'error');
            };
            
            // Send calculation task
            worker.postMessage({ type: 'calculate', data: 100000 });
        }
        
        // Weather App demo
        async function demoWeatherApp() {
            displayResult('weather-app-result', 'Loading...', 'info');
            
            let output = 'Weather App Demo (using mock data):\n\n';
            
            try {
                // Mock weather app functionality
                class MockWeatherApp {
                    constructor() {
                        this.storage = new StorageManager(localStorage);
                        this.currentLocation = null;
                    }
                    
                    async init() {
                        output += 'Initializing Weather App...\n';
                        
                        // Try to get cached location
                        this.currentLocation = this.storage.get('lastLocation');
                        
                        if (!this.currentLocation) {
                            output += 'No cached location found, using default location\n';
                            this.currentLocation = {
                                lat: 51.5074,
                                lon: -0.1278,
                                accuracy: 100
                            };
                            this.storage.set('lastLocation', this.currentLocation);
                        } else {
                            output += 'Using cached location\n';
                        }
                        
                        // Load weather data
                        const weatherData = await this.getWeatherData(this.currentLocation);
                        
                        output += `Weather data loaded successfully!\n`;
                        output += `Location: ${weatherData.name}\n`;
                        output += `Temperature: ${weatherData.main.temp}°C\n`;
                        output += `Description: ${weatherData.weather[0].description}\n`;
                        output += `Humidity: ${weatherData.main.humidity}%\n`;
                        output += `Wind Speed: ${weatherData.wind.speed} m/s\n`;
                        
                        return weatherData;
                    }
                    
                    async getWeatherData(location) {
                        // Mock weather data
                        return {
                            name: 'London',
                            main: {
                                temp: Math.floor(Math.random() * 30) + 10,
                                humidity: Math.floor(Math.random() * 40) + 40
                            },
                            weather: [{
                                description: 'Partly cloudy'
                            }],
                            wind: {
                                speed: Math.floor(Math.random() * 10) + 1
                            },
                            timestamp: Date.now()
                        };
                    }
                }
                
                const weatherApp = new MockWeatherApp();
                await weatherApp.init();
                
                output += '\nWeather App demo completed successfully!';
                displayResult('weather-app-result', output, 'success');
            } catch (error) {
                displayResult('weather-app-result', `Error: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>


