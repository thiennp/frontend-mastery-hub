<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Higher-Order Functions Examples - Level 3</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .example {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .example h3 {
            color: #495057;
            margin-top: 0;
        }
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .output {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        .function-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .function-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
        }
        .function-card h4 {
            color: #2c3e50;
            margin-top: 0;
        }
        .highlight {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Higher-Order Functions Examples</h1>
        <p>This page demonstrates higher-order functions that take other functions as arguments or return functions as results.</p>

        <div class="function-types">
            <div class="function-card">
                <h4>Functions as Arguments</h4>
                <p>Callbacks, built-in methods, and custom higher-order functions</p>
                <button onclick="demoFunctionsAsArguments()">Run Example</button>
            </div>
            <div class="function-card">
                <h4>Functions as Return Values</h4>
                <p>Function factories, partial application, and decorators</p>
                <button onclick="demoFunctionsAsReturnValues()">Run Example</button>
            </div>
            <div class="function-card">
                <h4>Function Composition</h4>
                <p>Combining functions to create new functionality</p>
                <button onclick="demoFunctionComposition()">Run Example</button>
            </div>
            <div class="function-card">
                <h4>Currying</h4>
                <p>Transforming multi-argument functions into single-argument functions</p>
                <button onclick="demoCurrying()">Run Example</button>
            </div>
            <div class="function-card">
                <h4>Memoization</h4>
                <p>Caching function results to improve performance</p>
                <button onclick="demoMemoization()">Run Example</button>
            </div>
            <div class="function-card">
                <h4>Practical Applications</h4>
                <p>Real-world examples and patterns</p>
                <button onclick="demoPracticalApplications()">Run Example</button>
            </div>
        </div>

        <div id="output" class="output" style="display: none;"></div>
    </div>

    <script>
        // Functions as Arguments
        function demoFunctionsAsArguments() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Basic callback example
            function processArray(arr, callback) {
                const result = [];
                for (let i = 0; i < arr.length; i++) {
                    result.push(callback(arr[i], i, arr));
                }
                return result;
            }
            
            const numbers = [1, 2, 3, 4, 5];
            
            // Double each number
            const doubled = processArray(numbers, x => x * 2);
            
            // Square each number
            const squared = processArray(numbers, x => x * x);
            
            // Convert to string
            const strings = processArray(numbers, x => `Number: ${x}`);
            
            // Built-in higher-order functions
            const evens = numbers.filter(x => x % 2 === 0);
            const sum = numbers.reduce((acc, x) => acc + x, 0);
            const found = numbers.find(x => x > 3);
            const hasEven = numbers.some(x => x % 2 === 0);
            const allPositive = numbers.every(x => x > 0);
            
            // Custom higher-order functions
            function transform(data, transformer) {
                if (Array.isArray(data)) {
                    return data.map(transformer);
                }
                return transformer(data);
            }
            
            const transformed = transform(numbers, x => x * 3);
            
            output.textContent = `Functions as Arguments Demo:

Custom processArray function:
- Original: [${numbers.join(', ')}]
- Doubled: [${doubled.join(', ')}]
- Squared: [${squared.join(', ')}]
- Strings: [${strings.join(', ')}]

Built-in higher-order functions:
- Filter evens: [${evens.join(', ')}]
- Reduce sum: ${sum}
- Find > 3: ${found}
- Some even: ${hasEven}
- All positive: ${allPositive}

Custom transform function:
- Transformed: [${transformed.join(', ')}]

Higher-order functions enable code reuse and abstraction.`;
        }

        // Functions as Return Values
        function demoFunctionsAsReturnValues() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Function factories
            function createMultiplier(factor) {
                return function(number) {
                    return number * factor;
                };
            }
            
            const double = createMultiplier(2);
            const triple = createMultiplier(3);
            
            // Function that creates validators
            function createValidator(rules) {
                return function(data) {
                    return rules.every(rule => rule(data));
                };
            }
            
            const isEmail = (data) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(data.email);
            const isRequired = (data) => data.name && data.email;
            const isAdult = (data) => data.age >= 18;
            
            const validateUser = createValidator([isEmail, isRequired, isAdult]);
            
            const user = { name: "John", email: "john@example.com", age: 30 };
            const isValid = validateUser(user);
            
            // Partial application
            function partial(fn, ...args) {
                return function(...remainingArgs) {
                    return fn(...args, ...remainingArgs);
                };
            }
            
            function add(a, b, c) {
                return a + b + c;
            }
            
            const add5 = partial(add, 5);
            const add5And10 = partial(add, 5, 10);
            
            // Function decorators
            function withLogging(fn) {
                return function(...args) {
                    console.log(`Calling ${fn.name} with arguments:`, args);
                    const result = fn(...args);
                    console.log(`Result:`, result);
                    return result;
                };
            }
            
            function withTiming(fn) {
                return function(...args) {
                    const start = performance.now();
                    const result = fn(...args);
                    const end = performance.now();
                    console.log(`${fn.name} took ${end - start} milliseconds`);
                    return result;
                };
            }
            
            const loggedAdd = withLogging(add);
            const timedAdd = withTiming(add);
            
            output.textContent = `Functions as Return Values Demo:

Function Factories:
- double(5) = ${double(5)}
- triple(5) = ${triple(5)}

Validator Factory:
- User validation: ${isValid}

Partial Application:
- add5(3, 2) = ${add5(3, 2)}
- add5And10(1) = ${add5And10(1)}

Function Decorators:
- withLogging and withTiming applied to add function
- Check console for logging and timing output

Functions can return other functions for:
1. Function factories and specialization
2. Partial application and currying
3. Function decorators and wrappers
4. Configuration and customization`;
        }

        // Function Composition
        function demoFunctionComposition() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Basic composition
            function addOne(x) {
                return x + 1;
            }
            
            function multiplyByTwo(x) {
                return x * 2;
            }
            
            function square(x) {
                return x * x;
            }
            
            // Manual composition
            function composed(x) {
                return square(multiplyByTwo(addOne(x)));
            }
            
            // Compose function (right to left)
            function compose(...functions) {
                return function(value) {
                    return functions.reduceRight((acc, fn) => fn(acc), value);
                };
            }
            
            // Pipe function (left to right)
            function pipe(...functions) {
                return function(value) {
                    return functions.reduce((acc, fn) => fn(acc), value);
                };
            }
            
            const composedFn = compose(square, multiplyByTwo, addOne);
            const pipedFn = pipe(addOne, multiplyByTwo, square);
            
            const input = 3;
            const composedResult = composedFn(input);
            const pipedResult = pipedFn(input);
            
            // Array composition
            function map(fn) {
                return function(array) {
                    return array.map(fn);
                };
            }
            
            function filter(predicate) {
                return function(array) {
                    return array.filter(predicate);
                };
            }
            
            function reduce(reducer, initialValue) {
                return function(array) {
                    return array.reduce(reducer, initialValue);
                };
            }
            
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            
            const processNumbers = pipe(
                filter(x => x % 2 === 0),
                map(x => x * x),
                reduce((acc, x) => acc + x, 0)
            );
            
            const result = processNumbers(numbers);
            
            output.textContent = `Function Composition Demo:

Basic Composition:
- Input: ${input}
- Composed (right to left): ${composedResult}
- Piped (left to right): ${pipedResult}
- Both give same result: ((3 + 1) * 2)Â² = 64

Array Composition:
- Original: [${numbers.join(', ')}]
- Filter evens: [2, 4, 6, 8, 10]
- Square each: [4, 16, 36, 64, 100]
- Sum all: ${result}

Composition enables:
1. Building complex logic from simple functions
2. Creating reusable transformation pipelines
3. Improving code readability and maintainability
4. Enabling functional programming patterns`;
        }

        // Currying
        function demoCurrying() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Basic currying
            function add(a, b, c) {
                return a + b + c;
            }
            
            // Manual currying
            function curriedAdd(a) {
                return function(b) {
                    return function(c) {
                        return a + b + c;
                    };
                };
            }
            
            // Auto-currying
            function curry(fn) {
                return function curried(...args) {
                    if (args.length >= fn.length) {
                        return fn(...args);
                    }
                    return function(...nextArgs) {
                        return curried(...args, ...nextArgs);
                    };
                };
            }
            
            const curriedAdd = curry(add);
            
            // Using curried functions
            const result1 = curriedAdd(1)(2)(3);
            const result2 = curriedAdd(1, 2)(3);
            const result3 = curriedAdd(1)(2, 3);
            const result4 = curriedAdd(1, 2, 3);
            
            // Partial application
            const add5 = curriedAdd(5);
            const add5And10 = add5(10);
            const finalResult = add5And10(3);
            
            // Currying with different functions
            function multiply(a, b, c) {
                return a * b * c;
            }
            
            const curriedMultiply = curry(multiply);
            const multiplyBy2 = curriedMultiply(2);
            const multiplyBy2And3 = multiplyBy2(3);
            const multiplyResult = multiplyBy2And3(4);
            
            output.textContent = `Currying Demo:

Basic Currying:
- add(1, 2, 3) = ${result1}
- add(1, 2)(3) = ${result2}
- add(1)(2, 3) = ${result3}
- add(1, 2, 3) = ${result4}

Partial Application:
- add5 = add(5)
- add5And10 = add5(10)
- add5And10(3) = ${finalResult}

Multiply Example:
- multiply(2, 3, 4) = ${multiplyResult}

Currying enables:
1. Partial application and specialization
2. Function composition and pipelines
3. Creating reusable function variants
4. Enabling functional programming patterns`;
        }

        // Memoization
        function demoMemoization() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Basic memoization
            function memoize(fn) {
                const cache = new Map();
                
                return function(...args) {
                    const key = JSON.stringify(args);
                    
                    if (cache.has(key)) {
                        console.log('Cache hit');
                        return cache.get(key);
                    }
                    
                    console.log('Cache miss');
                    const result = fn(...args);
                    cache.set(key, result);
                    return result;
                };
            }
            
            // Expensive function
            function expensiveCalculation(n) {
                console.log(`Calculating for ${n}`);
                return n * n * n;
            }
            
            const memoizedCalculation = memoize(expensiveCalculation);
            
            // Test memoization
            const result1 = memoizedCalculation(5);
            const result2 = memoizedCalculation(5);
            const result3 = memoizedCalculation(3);
            const result4 = memoizedCalculation(3);
            
            // Memoization with cache size limit
            function memoizeWithLimit(fn, maxSize = 100) {
                const cache = new Map();
                
                return function(...args) {
                    const key = JSON.stringify(args);
                    
                    if (cache.has(key)) {
                        return cache.get(key);
                    }
                    
                    const result = fn(...args);
                    
                    if (cache.size >= maxSize) {
                        const firstKey = cache.keys().next().value;
                        cache.delete(firstKey);
                    }
                    
                    cache.set(key, result);
                    return result;
                };
            }
            
            const limitedMemoized = memoizeWithLimit(expensiveCalculation, 2);
            const limitedResult1 = limitedMemoized(1);
            const limitedResult2 = limitedMemoized(2);
            const limitedResult3 = limitedMemoized(3);
            const limitedResult4 = limitedMemoized(1); // Should be recalculated
            
            output.textContent = `Memoization Demo:

Basic Memoization:
- First call (5): ${result1} (calculated)
- Second call (5): ${result2} (cached)
- First call (3): ${result3} (calculated)
- Second call (3): ${result4} (cached)

Limited Memoization:
- Cache size limit: 2
- Results: ${limitedResult1}, ${limitedResult2}, ${limitedResult3}, ${limitedResult4}
- Check console for cache hit/miss messages

Memoization benefits:
1. Prevents recalculation of expensive operations
2. Improves performance for repeated calls
3. Enables caching strategies
4. Useful for recursive functions and API calls`;
        }

        // Practical Applications
        function demoPracticalApplications() {
            const output = document.getElementById('output');
            output.style.display = 'block';
            
            // Event handling
            function createEventHandler(handler) {
                return function(event) {
                    event.preventDefault();
                    handler(event);
                };
            }
            
            function handleClick(event) {
                console.log('Button clicked!');
            }
            
            const clickHandler = createEventHandler(handleClick);
            
            // API wrapper
            function createApiWrapper(baseURL) {
                return function(endpoint, options = {}) {
                    const url = `${baseURL}${endpoint}`;
                    const config = {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                            ...options.headers
                        },
                        ...options
                    };
                    
                    return {
                        url,
                        config,
                        method: config.method
                    };
                };
            }
            
            const api = createApiWrapper('https://api.example.com');
            const getUsers = () => api('/users');
            const createUser = (userData) => api('/users', {
                method: 'POST',
                body: JSON.stringify(userData)
            });
            
            // Middleware pattern
            function createMiddleware(middlewares) {
                return function(handler) {
                    return function(...args) {
                        let index = 0;
                        
                        function next() {
                            if (index < middlewares.length) {
                                const middleware = middlewares[index++];
                                return middleware(...args, next);
                            }
                            return handler(...args);
                        }
                        
                        return next();
                    };
                };
            }
            
            function loggingMiddleware(req, res, next) {
                console.log(`Request: ${req.method} ${req.url}`);
                return next();
            }
            
            function authMiddleware(req, res, next) {
                if (req.headers.authorization) {
                    return next();
                }
                throw new Error('Unauthorized');
            }
            
            function handler(req, res) {
                return { message: 'Success' };
            }
            
            const middleware = createMiddleware([loggingMiddleware, authMiddleware]);
            const wrappedHandler = middleware(handler);
            
            // Data processing pipeline
            function createDataProcessor() {
                const steps = [];
                
                return {
                    addStep: function(step) {
                        steps.push(step);
                        return this;
                    },
                    process: function(data) {
                        return steps.reduce((acc, step) => step(acc), data);
                    }
                };
            }
            
            const processor = createDataProcessor()
                .addStep(data => data.filter(item => item && item.id))
                .addStep(data => data.map(item => ({ ...item, timestamp: new Date() })))
                .addStep(data => data.sort((a, b) => a.id - b.id));
            
            const rawData = [
                { id: 3, name: "John" },
                { id: 1, name: "Jane" },
                { id: 2, name: "Bob" },
                null,
                { id: 4, name: "Alice" }
            ];
            
            const processedData = processor.process(rawData);
            
            output.textContent = `Practical Applications Demo:

Event Handling:
- Event handler created with preventDefault
- Ready to be attached to DOM elements

API Wrapper:
- Base URL: https://api.example.com
- GET /users: ${JSON.stringify(getUsers(), null, 2)}
- POST /users: ${JSON.stringify(createUser({ name: "John" }), null, 2)}

Middleware Pattern:
- Middleware chain created with logging and auth
- Handler wrapped with middleware

Data Processing Pipeline:
- Original data: ${JSON.stringify(rawData, null, 2)}
- Processed data: ${JSON.stringify(processedData, null, 2)}

Higher-order functions enable:
1. Event handling and DOM manipulation
2. API wrappers and HTTP clients
3. Middleware and request processing
4. Data transformation pipelines
5. Plugin systems and extensibility`;
        }
    </script>
</body>
</html>

