<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 22: Mobile Development - Frontend Mastery Hub</title>
    <link rel="stylesheet" href="level22-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="level-container">
        <header class="level-header">
            <div class="level-info">
                <h1><i class="fas fa-mobile-alt"></i> Level 22: Mobile Development</h1>
                <p>Master mobile app development with React Native, Flutter, PWA, and cross-platform strategies</p>
                <div class="level-stats">
                    <span class="stat"><i class="fas fa-code"></i> 5 Exercises</span>
                    <span class="stat"><i class="fas fa-clock"></i> 45-60 min</span>
                    <span class="stat"><i class="fas fa-star"></i> Advanced</span>
                </div>
            </div>
            <div class="progress-indicator">
                <div class="progress-bar">
                    <div class="progress-fill" id="overallProgress"></div>
                </div>
                <span class="progress-text">0/5 Complete</span>
            </div>
        </header>

        <div class="exercises-container">
            <!-- Exercise 1: React Native Fundamentals -->
            <div class="exercise-card" data-exercise="1">
                <div class="exercise-header">
                    <h3><i class="fab fa-react"></i> Exercise 1: React Native Fundamentals</h3>
                    <div class="exercise-status">
                        <i class="fas fa-circle status-pending"></i>
                        <span>Pending</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div class="exercise-description">
                        <p>Learn React Native fundamentals including components, navigation, state management, and platform-specific code.</p>
                        <div class="exercise-hints">
                            <h4><i class="fas fa-lightbulb"></i> Key Concepts:</h4>
                            <ul>
                                <li>React Native components and styling</li>
                                <li>Navigation with React Navigation</li>
                                <li>State management with Redux/Context</li>
                                <li>Platform-specific code and APIs</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-editor">
                        <div class="editor-header">
                            <span>React Native App Implementation</span>
                            <button class="run-btn" onclick="runExercise(1)">
                                <i class="fas fa-play"></i> Run
                            </button>
                        </div>
                        <div class="editor-container">
                            <textarea id="editor1" placeholder="// React Native App Implementation
import React, { useState, useEffect } from 'react';
import {
  View,
  Text,
  StyleSheet,
  TouchableOpacity,
  FlatList,
  Alert,
  Platform
} from 'react-native';
import { NavigationContainer } from '@react-navigation/native';
import { createStackNavigator } from '@react-navigation/stack';

// Main App Component
const App = () => {
  return (
    <NavigationContainer>
      <Stack.Navigator>
        <Stack.Screen name="Home" component={HomeScreen} />
        <Stack.Screen name="Details" component={DetailsScreen} />
      </Stack.Navigator>
    </NavigationContainer>
  );
};

// Home Screen Component
const HomeScreen = ({ navigation }) => {
  const [todos, setTodos] = useState([]);
  const [newTodo, setNewTodo] = useState('');

  const addTodo = () => {
    if (newTodo.trim()) {
      setTodos([...todos, {
        id: Date.now(),
        text: newTodo,
        completed: false
      }]);
      setNewTodo('');
    }
  };

  const toggleTodo = (id) => {
    setTodos(todos.map(todo =>
      todo.id === id ? { ...todo, completed: !todo.completed } : todo
    ));
  };

  return (
    <View style={styles.container}>
      <Text style={styles.title}>React Native Todo App</Text>
      
      <View style={styles.inputContainer}>
        <TextInput
          style={styles.input}
          value={newTodo}
          onChangeText={setNewTodo}
          placeholder="Add a new todo..."
          placeholderTextColor="#999"
        />
        <TouchableOpacity style={styles.addButton} onPress={addTodo}>
          <Text style={styles.buttonText}>Add</Text>
        </TouchableOpacity>
      </View>

      <FlatList
        data={todos}
        keyExtractor={item => item.id.toString()}
        renderItem={({ item }) => (
          <TouchableOpacity
            style={[styles.todoItem, item.completed && styles.completedTodo]}
            onPress={() => toggleTodo(item.id)}
          >
            <Text style={[styles.todoText, item.completed && styles.completedText]}>
              {item.text}
            </Text>
          </TouchableOpacity>
        )}
      />
    </View>
  );
};

// Styles
const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 20,
    backgroundColor: '#f5f5f5'
  },
  title: {
    fontSize: 24,
    fontWeight: 'bold',
    marginBottom: 20,
    textAlign: 'center'
  },
  inputContainer: {
    flexDirection: 'row',
    marginBottom: 20
  },
  input: {
    flex: 1,
    borderWidth: 1,
    borderColor: '#ddd',
    borderRadius: 8,
    padding: 10,
    marginRight: 10,
    backgroundColor: 'white'
  },
  addButton: {
    backgroundColor: '#007AFF',
    paddingHorizontal: 20,
    paddingVertical: 10,
    borderRadius: 8,
    justifyContent: 'center'
  },
  buttonText: {
    color: 'white',
    fontWeight: 'bold'
  },
  todoItem: {
    backgroundColor: 'white',
    padding: 15,
    marginBottom: 10,
    borderRadius: 8,
    borderWidth: 1,
    borderColor: '#ddd'
  },
  completedTodo: {
    backgroundColor: '#e8f5e8',
    borderColor: '#4CAF50'
  },
  todoText: {
    fontSize: 16
  },
  completedText: {
    textDecorationLine: 'line-through',
    color: '#666'
  }
});

export default App;"></textarea>
                        </div>
                    </div>
                    <div class="output-panel" id="output1">
                        <div class="output-header">
                            <span>React Native App Status</span>
                            <div class="metrics">
                                <span class="metric">Components: <span id="rnComponents">0</span></span>
                                <span class="metric">Screens: <span id="rnScreens">0</span></span>
                                <span class="metric">Platform: <span id="rnPlatform">iOS/Android</span></span>
                            </div>
                        </div>
                        <div class="output-content" id="outputContent1"></div>
                    </div>
                </div>
            </div>

            <!-- Exercise 2: Flutter Development -->
            <div class="exercise-card" data-exercise="2">
                <div class="exercise-header">
                    <h3><i class="fas fa-mobile"></i> Exercise 2: Flutter Development</h3>
                    <div class="exercise-status">
                        <i class="fas fa-circle status-pending"></i>
                        <span>Pending</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div class="exercise-description">
                        <p>Build Flutter applications with Dart, widgets, state management, and platform integration.</p>
                        <div class="exercise-hints">
                            <h4><i class="fas fa-lightbulb"></i> Key Concepts:</h4>
                            <ul>
                                <li>Flutter widgets and layout system</li>
                                <li>State management with Provider/Bloc</li>
                                <li>Navigation and routing</li>
                                <li>Platform channels and native integration</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-editor">
                        <div class="editor-header">
                            <span>Flutter App Implementation</span>
                            <button class="run-btn" onclick="runExercise(2)">
                                <i class="fas fa-play"></i> Run
                            </button>
                        </div>
                        <div class="editor-container">
                            <textarea id="editor2" placeholder="// Flutter App Implementation
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return ChangeNotifierProvider(
      create: (context) => TodoProvider(),
      child: MaterialApp(
        title: 'Flutter Todo App',
        theme: ThemeData(
          primarySwatch: Colors.blue,
          visualDensity: VisualDensity.adaptivePlatformDensity,
        ),
        home: TodoListScreen(),
      ),
    );
  }
}

class TodoListScreen extends StatefulWidget {
  @override
  _TodoListScreenState createState() => _TodoListScreenState();
}

class _TodoListScreenState extends State<TodoListScreen> {
  final TextEditingController _textController = TextEditingController();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Flutter Todo App'),
        backgroundColor: Colors.blue[600],
        elevation: 0,
      ),
      body: Consumer<TodoProvider>(
        builder: (context, todoProvider, child) {
          return Column(
            children: [
              Padding(
                padding: EdgeInsets.all(16.0),
                child: Row(
                  children: [
                    Expanded(
                      child: TextField(
                        controller: _textController,
                        decoration: InputDecoration(
                          hintText: 'Add a new todo...',
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(8.0),
                          ),
                        ),
                      ),
                    ),
                    SizedBox(width: 8),
                    ElevatedButton(
                      onPressed: () {
                        if (_textController.text.isNotEmpty) {
                          todoProvider.addTodo(_textController.text);
                          _textController.clear();
                        }
                      },
                      child: Text('Add'),
                      style: ElevatedButton.styleFrom(
                        backgroundColor: Colors.blue[600],
                        shape: RoundedRectangleBorder(
                          borderRadius: BorderRadius.circular(8.0),
                        ),
                      ),
                    ),
                  ],
                ),
              ),
              Expanded(
                child: ListView.builder(
                  itemCount: todoProvider.todos.length,
                  itemBuilder: (context, index) {
                    final todo = todoProvider.todos[index];
                    return Card(
                      margin: EdgeInsets.symmetric(horizontal: 16, vertical: 4),
                      child: ListTile(
                        leading: Checkbox(
                          value: todo.completed,
                          onChanged: (value) {
                            todoProvider.toggleTodo(todo.id);
                          },
                        ),
                        title: Text(
                          todo.text,
                          style: TextStyle(
                            decoration: todo.completed 
                                ? TextDecoration.lineThrough 
                                : TextDecoration.none,
                            color: todo.completed ? Colors.grey : Colors.black,
                          ),
                        ),
                        trailing: IconButton(
                          icon: Icon(Icons.delete, color: Colors.red),
                          onPressed: () {
                            todoProvider.deleteTodo(todo.id);
                          },
                        ),
                      ),
                    );
                  },
                ),
              ),
            ],
          );
        },
      ),
    );
  }
}

class Todo {
  final int id;
  final String text;
  bool completed;

  Todo({required this.id, required this.text, this.completed = false});
}

class TodoProvider extends ChangeNotifier {
  List<Todo> _todos = [];
  int _nextId = 1;

  List<Todo> get todos => _todos;

  void addTodo(String text) {
    _todos.add(Todo(id: _nextId++, text: text));
    notifyListeners();
  }

  void toggleTodo(int id) {
    final todo = _todos.firstWhere((todo) => todo.id == id);
    todo.completed = !todo.completed;
    notifyListeners();
  }

  void deleteTodo(int id) {
    _todos.removeWhere((todo) => todo.id == id);
    notifyListeners();
  }
}"></textarea>
                        </div>
                    </div>
                    <div class="output-panel" id="output2">
                        <div class="output-header">
                            <span>Flutter App Status</span>
                            <div class="metrics">
                                <span class="metric">Widgets: <span id="flutterWidgets">0</span></span>
                                <span class="metric">Screens: <span id="flutterScreens">0</span></span>
                                <span class="metric">Platform: <span id="flutterPlatform">iOS/Android</span></span>
                            </div>
                        </div>
                        <div class="output-content" id="outputContent2"></div>
                    </div>
                </div>
            </div>

            <!-- Exercise 3: Progressive Web Apps (PWA) -->
            <div class="exercise-card" data-exercise="3">
                <div class="exercise-header">
                    <h3><i class="fas fa-globe"></i> Exercise 3: Progressive Web Apps</h3>
                    <div class="exercise-status">
                        <i class="fas fa-circle status-pending"></i>
                        <span>Pending</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div class="exercise-description">
                        <p>Create Progressive Web Apps with service workers, offline functionality, and native app-like features.</p>
                        <div class="exercise-hints">
                            <h4><i class="fas fa-lightbulb"></i> Key Concepts:</h4>
                            <ul>
                                <li>Service Workers and caching strategies</li>
                                <li>Web App Manifest and installation</li>
                                <li>Offline functionality and sync</li>
                                <li>Push notifications and background sync</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-editor">
                        <div class="editor-header">
                            <span>PWA Implementation</span>
                            <button class="run-btn" onclick="runExercise(3)">
                                <i class="fas fa-play"></i> Run
                            </button>
                        </div>
                        <div class="editor-container">
                            <textarea id="editor3" placeholder="// Progressive Web App Implementation
// Service Worker (sw.js)
const CACHE_NAME = 'pwa-todo-app-v1';
const urlsToCache = [
  '/',
  '/index.html',
  '/styles.css',
  '/script.js',
  '/manifest.json'
];

self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then((cache) => cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request)
      .then((response) => {
        if (response) {
          return response;
        }
        return fetch(event.request);
      })
  );
});

// Web App Manifest (manifest.json)
{
  "name": "Todo PWA App",
  "short_name": "TodoPWA",
  "description": "A Progressive Web App for managing todos",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#007AFF",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}

// PWA Main App
class PWATodoApp {
  constructor() {
    this.todos = JSON.parse(localStorage.getItem('todos') || '[]');
    this.init();
  }

  init() {
    this.render();
    this.setupEventListeners();
    this.registerServiceWorker();
    this.setupInstallPrompt();
  }

  render() {
    const app = document.getElementById('app');
    app.innerHTML = \`
      <div class="pwa-container">
        <header class="pwa-header">
          <h1>ðŸ“± Todo PWA</h1>
          <button id="installBtn" class="install-btn">Install App</button>
        </header>
        
        <div class="todo-input">
          <input type="text" id="todoInput" placeholder="Add a new todo...">
          <button id="addBtn">Add</button>
        </div>
        
        <div class="todo-list" id="todoList"></div>
        
        <div class="offline-indicator" id="offlineIndicator">
          ðŸ“¡ You're offline - changes will sync when online
        </div>
      </div>
    \`;
  }

  setupEventListeners() {
    document.getElementById('addBtn').addEventListener('click', () => this.addTodo());
    document.getElementById('todoInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') this.addTodo();
    });
  }

  addTodo() {
    const input = document.getElementById('todoInput');
    const text = input.value.trim();
    
    if (text) {
      const todo = {
        id: Date.now(),
        text: text,
        completed: false,
        timestamp: new Date().toISOString()
      };
      
      this.todos.push(todo);
      this.saveTodos();
      this.renderTodos();
      input.value = '';
    }
  }

  toggleTodo(id) {
    const todo = this.todos.find(t => t.id === id);
    if (todo) {
      todo.completed = !todo.completed;
      this.saveTodos();
      this.renderTodos();
    }
  }

  deleteTodo(id) {
    this.todos = this.todos.filter(t => t.id !== id);
    this.saveTodos();
    this.renderTodos();
  }

  renderTodos() {
    const todoList = document.getElementById('todoList');
    todoList.innerHTML = this.todos.map(todo => \`
      <div class="todo-item \${todo.completed ? 'completed' : ''}">
        <input type="checkbox" \${todo.completed ? 'checked' : ''} 
               onchange="app.toggleTodo(\${todo.id})">
        <span class="todo-text">\${todo.text}</span>
        <button onclick="app.deleteTodo(\${todo.id})" class="delete-btn">Ã—</button>
      </div>
    \`).join('');
  }

  saveTodos() {
    localStorage.setItem('todos', JSON.stringify(this.todos));
  }

  async registerServiceWorker() {
    if ('serviceWorker' in navigator) {
      try {
        await navigator.serviceWorker.register('/sw.js');
        console.log('Service Worker registered');
      } catch (error) {
        console.log('Service Worker registration failed:', error);
      }
    }
  }

  setupInstallPrompt() {
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'block';
    });

    document.getElementById('installBtn').addEventListener('click', async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log('PWA install outcome:', outcome);
        deferredPrompt = null;
        document.getElementById('installBtn').style.display = 'none';
      }
    });
  }
}

// Initialize PWA
const app = new PWATodoApp();"></textarea>
                        </div>
                    </div>
                    <div class="output-panel" id="output3">
                        <div class="output-header">
                            <span>PWA Status</span>
                            <div class="metrics">
                                <span class="metric">Service Worker: <span id="pwaSwStatus">Not Registered</span></span>
                                <span class="metric">Manifest: <span id="pwaManifestStatus">Not Loaded</span></span>
                                <span class="metric">Installable: <span id="pwaInstallable">No</span></span>
                            </div>
                        </div>
                        <div class="output-content" id="outputContent3"></div>
                    </div>
                </div>
            </div>

            <!-- Exercise 4: Mobile Optimization -->
            <div class="exercise-card" data-exercise="4">
                <div class="exercise-header">
                    <h3><i class="fas fa-tachometer-alt"></i> Exercise 4: Mobile Optimization</h3>
                    <div class="exercise-status">
                        <i class="fas fa-circle status-pending"></i>
                        <span>Pending</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div class="exercise-description">
                        <p>Optimize mobile web applications for performance, touch interactions, and responsive design.</p>
                        <div class="exercise-hints">
                            <h4><i class="fas fa-lightbulb"></i> Key Concepts:</h4>
                            <ul>
                                <li>Touch-friendly UI and gestures</li>
                                <li>Mobile performance optimization</li>
                                <li>Responsive design patterns</li>
                                <li>Mobile-specific APIs and features</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-editor">
                        <div class="editor-header">
                            <span>Mobile Optimization Implementation</span>
                            <button class="run-btn" onclick="runExercise(4)">
                                <i class="fas fa-play"></i> Run
                            </button>
                        </div>
                        <div class="editor-container">
                            <textarea id="editor4" placeholder="// Mobile Optimization Implementation
// Touch-friendly mobile app
class MobileOptimizedApp {
  constructor() {
    this.touchStartY = 0;
    this.touchStartX = 0;
    this.isScrolling = false;
    this.init();
  }

  init() {
    this.setupViewport();
    this.setupTouchEvents();
    this.setupPerformanceOptimizations();
    this.setupResponsiveDesign();
    this.render();
  }

  setupViewport() {
    const viewport = document.querySelector('meta[name="viewport"]');
    if (!viewport) {
      const meta = document.createElement('meta');
      meta.name = 'viewport';
      meta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
      document.head.appendChild(meta);
    }
  }

  setupTouchEvents() {
    // Touch gesture handling
    document.addEventListener('touchstart', (e) => {
      this.touchStartY = e.touches[0].clientY;
      this.touchStartX = e.touches[0].clientX;
      this.isScrolling = false;
    }, { passive: true });

    document.addEventListener('touchmove', (e) => {
      if (!this.touchStartY || !this.touchStartX) return;
      
      const touchY = e.touches[0].clientY;
      const touchX = e.touches[0].clientX;
      const diffY = this.touchStartY - touchY;
      const diffX = this.touchStartX - touchX;
      
      if (Math.abs(diffX) > Math.abs(diffY)) {
        this.isScrolling = false;
      } else {
        this.isScrolling = true;
      }
    }, { passive: true });

    document.addEventListener('touchend', (e) => {
      if (!this.isScrolling) {
        this.handleTap(e);
      }
    }, { passive: true });
  }

  setupPerformanceOptimizations() {
    // Lazy loading for images
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove('lazy');
            imageObserver.unobserve(img);
          }
        });
      });

      document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
      });
    }

    // Debounced scroll events
    let scrollTimeout;
    window.addEventListener('scroll', () => {
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        this.handleScroll();
      }, 16); // ~60fps
    }, { passive: true });
  }

  setupResponsiveDesign() {
    // Responsive breakpoints
    const breakpoints = {
      mobile: 768,
      tablet: 1024,
      desktop: 1200
    };

    const updateLayout = () => {
      const width = window.innerWidth;
      let deviceType = 'desktop';
      
      if (width <= breakpoints.mobile) {
        deviceType = 'mobile';
      } else if (width <= breakpoints.tablet) {
        deviceType = 'tablet';
      }
      
      document.body.className = \`device-\${deviceType}\`;
      this.updateLayoutForDevice(deviceType);
    };

    window.addEventListener('resize', updateLayout);
    updateLayout();
  }

  updateLayoutForDevice(deviceType) {
    const container = document.querySelector('.mobile-container');
    if (!container) return;

    switch (deviceType) {
      case 'mobile':
        container.style.padding = '10px';
        container.style.fontSize = '14px';
        break;
      case 'tablet':
        container.style.padding = '20px';
        container.style.fontSize = '16px';
        break;
      default:
        container.style.padding = '30px';
        container.style.fontSize = '18px';
    }
  }

  render() {
    const app = document.getElementById('app');
    app.innerHTML = \`
      <div class="mobile-container">
        <header class="mobile-header">
          <h1>ðŸ“± Mobile Optimized App</h1>
          <div class="device-info">
            <span id="deviceType">Detecting...</span>
            <span id="connectionStatus">Online</span>
          </div>
        </header>
        
        <div class="mobile-content">
          <div class="touch-area" id="touchArea">
            <div class="touch-indicator">ðŸ‘† Touch me!</div>
          </div>
          
          <div class="performance-metrics">
            <div class="metric">
              <span class="label">FPS:</span>
              <span id="fpsCounter">60</span>
            </div>
            <div class="metric">
              <span class="label">Memory:</span>
              <span id="memoryUsage">0 MB</span>
            </div>
          </div>
        </div>
      </div>
    \`;

    this.setupMobileFeatures();
  }

  setupMobileFeatures() {
    // Device orientation
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        this.updateLayoutForDevice(this.getCurrentDeviceType());
      }, 100);
    });

    // Network status
    window.addEventListener('online', () => {
      document.getElementById('connectionStatus').textContent = 'Online';
      document.getElementById('connectionStatus').className = 'online';
    });

    window.addEventListener('offline', () => {
      document.getElementById('connectionStatus').textContent = 'Offline';
      document.getElementById('connectionStatus').className = 'offline';
    });

    // Performance monitoring
    this.startPerformanceMonitoring();
  }

  startPerformanceMonitoring() {
    let frameCount = 0;
    let lastTime = performance.now();

    const countFrames = () => {
      frameCount++;
      const currentTime = performance.now();
      
      if (currentTime - lastTime >= 1000) {
        const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
        document.getElementById('fpsCounter').textContent = fps;
        frameCount = 0;
        lastTime = currentTime;
      }
      
      requestAnimationFrame(countFrames);
    };

    requestAnimationFrame(countFrames);

    // Memory usage (if available)
    if ('memory' in performance) {
      setInterval(() => {
        const memory = performance.memory;
        const usedMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);
        document.getElementById('memoryUsage').textContent = \`\${usedMB} MB\`;
      }, 1000);
    }
  }

  handleTap(e) {
    const touchArea = document.getElementById('touchArea');
    if (touchArea && touchArea.contains(e.target)) {
      touchArea.style.transform = 'scale(0.95)';
      setTimeout(() => {
        touchArea.style.transform = 'scale(1)';
      }, 150);
    }
  }

  handleScroll() {
    // Handle scroll-based animations or optimizations
    const scrollY = window.scrollY;
    const header = document.querySelector('.mobile-header');
    
    if (header) {
      if (scrollY > 100) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    }
  }

  getCurrentDeviceType() {
    const width = window.innerWidth;
    if (width <= 768) return 'mobile';
    if (width <= 1024) return 'tablet';
    return 'desktop';
  }
}

// Initialize mobile optimized app
const mobileApp = new MobileOptimizedApp();"></textarea>
                        </div>
                    </div>
                    <div class="output-panel" id="output4">
                        <div class="output-header">
                            <span>Mobile Optimization Status</span>
                            <div class="metrics">
                                <span class="metric">FPS: <span id="mobileFps">60</span></span>
                                <span class="metric">Memory: <span id="mobileMemory">0 MB</span></span>
                                <span class="metric">Device: <span id="mobileDevice">Mobile</span></span>
                            </div>
                        </div>
                        <div class="output-content" id="outputContent4"></div>
                    </div>
                </div>
            </div>

            <!-- Exercise 5: Cross-Platform Development -->
            <div class="exercise-card" data-exercise="5">
                <div class="exercise-header">
                    <h3><i class="fas fa-sync-alt"></i> Exercise 5: Cross-Platform Development</h3>
                    <div class="exercise-status">
                        <i class="fas fa-circle status-pending"></i>
                        <span>Pending</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div class="exercise-description">
                        <p>Master cross-platform development strategies, code sharing, and platform-specific optimizations.</p>
                        <div class="exercise-hints">
                            <h4><i class="fas fa-lightbulb"></i> Key Concepts:</h4>
                            <ul>
                                <li>Code sharing between platforms</li>
                                <li>Platform-specific implementations</li>
                                <li>Unified development workflows</li>
                                <li>Testing across platforms</li>
                            </ul>
                        </div>
                    </div>
                    <div class="code-editor">
                        <div class="editor-header">
                            <span>Cross-Platform Implementation</span>
                            <button class="run-btn" onclick="runExercise(5)">
                                <i class="fas fa-play"></i> Run
                            </button>
                        </div>
                        <div class="editor-container">
                            <textarea id="editor5" placeholder="// Cross-Platform Development Implementation
// Shared business logic
class TodoService {
  constructor() {
    this.todos = [];
    this.platform = this.detectPlatform();
  }

  detectPlatform() {
    if (typeof window !== 'undefined') {
      // Web platform
      return 'web';
    } else if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {
      // React Native
      return 'react-native';
    } else if (typeof process !== 'undefined' && process.versions && process.versions.node) {
      // Node.js
      return 'node';
    }
    return 'unknown';
  }

  async addTodo(text) {
    const todo = {
      id: Date.now(),
      text: text,
      completed: false,
      platform: this.platform,
      timestamp: new Date().toISOString()
    };

    this.todos.push(todo);
    await this.saveTodos();
    return todo;
  }

  async toggleTodo(id) {
    const todo = this.todos.find(t => t.id === id);
    if (todo) {
      todo.completed = !todo.completed;
      await this.saveTodos();
    }
    return todo;
  }

  async deleteTodo(id) {
    this.todos = this.todos.filter(t => t.id !== id);
    await this.saveTodos();
  }

  async saveTodos() {
    switch (this.platform) {
      case 'web':
        localStorage.setItem('todos', JSON.stringify(this.todos));
        break;
      case 'react-native':
        // Use AsyncStorage in React Native
        const AsyncStorage = require('@react-native-async-storage/async-storage');
        await AsyncStorage.setItem('todos', JSON.stringify(this.todos));
        break;
      default:
        // File system for Node.js
        const fs = require('fs');
        fs.writeFileSync('todos.json', JSON.stringify(this.todos));
    }
  }

  async loadTodos() {
    try {
      let data;
      switch (this.platform) {
        case 'web':
          data = localStorage.getItem('todos');
          break;
        case 'react-native':
          const AsyncStorage = require('@react-native-async-storage/async-storage');
          data = await AsyncStorage.getItem('todos');
          break;
        default:
          const fs = require('fs');
          data = fs.readFileSync('todos.json', 'utf8');
      }
      
      this.todos = data ? JSON.parse(data) : [];
    } catch (error) {
      console.error('Error loading todos:', error);
      this.todos = [];
    }
  }
}

// Platform-specific UI components
class PlatformUI {
  constructor(platform) {
    this.platform = platform;
  }

  createButton(text, onClick) {
    switch (this.platform) {
      case 'web':
        return \`<button onclick="\${onClick}" class="btn">\${text}</button>\`;
      case 'react-native':
        return \`<TouchableOpacity onPress={\${onClick}}>
          <Text>\${text}</Text>
        </TouchableOpacity>\`;
      case 'flutter':
        return \`ElevatedButton(
          onPressed: \${onClick},
          child: Text('\${text}'),
        )\`;
      default:
        return \`<button>\${text}</button>\`;
    }
  }

  createInput(placeholder, value, onChange) {
    switch (this.platform) {
      case 'web':
        return \`<input type="text" placeholder="\${placeholder}" value="\${value}" onchange="\${onChange}" />\`;
      case 'react-native':
        return \`<TextInput
          placeholder="\${placeholder}"
          value={\${value}}
          onChangeText={\${onChange}}
        />\`;
      case 'flutter':
        return \`TextField(
          decoration: InputDecoration(hintText: '\${placeholder}'),
          controller: \${value},
          onChanged: \${onChange},
        )\`;
      default:
        return \`<input placeholder="\${placeholder}" />\`;
    }
  }
}

// Cross-platform app class
class CrossPlatformApp {
  constructor() {
    this.todoService = new TodoService();
    this.ui = new PlatformUI(this.todoService.platform);
    this.init();
  }

  async init() {
    await this.todoService.loadTodos();
    this.render();
    this.setupEventListeners();
  }

  render() {
    const app = document.getElementById('app');
    app.innerHTML = \`
      <div class="cross-platform-container">
        <header class="app-header">
          <h1>ðŸ”„ Cross-Platform Todo App</h1>
          <div class="platform-info">
            <span>Platform: \${this.todoService.platform}</span>
            <span>Platform: \${this.todoService.platform}</span>
          </div>
        </header>
        
        <div class="todo-input">
          \${this.ui.createInput('Add a new todo...', '', 'this.addTodo()')}
          \${this.ui.createButton('Add', 'this.addTodo()')}
        </div>
        
        <div class="todo-list" id="todoList"></div>
        
        <div class="platform-features">
          <h3>Platform-Specific Features</h3>
          <div class="features-list">
            \${this.getPlatformFeatures()}
          </div>
        </div>
      </div>
    \`;
  }

  getPlatformFeatures() {
    const features = {
      'web': [
        'Service Workers',
        'Web APIs',
        'Local Storage',
        'PWA Support'
      ],
      'react-native': [
        'Native Modules',
        'Platform-specific Code',
        'AsyncStorage',
        'Push Notifications'
      ],
      'flutter': [
        'Platform Channels',
        'Native Plugins',
        'Shared Preferences',
        'Platform Views'
      ]
    };

    const platformFeatures = features[this.todoService.platform] || [];
    return platformFeatures.map(feature => \`<div class="feature-item">\${feature}</div>\`).join('');
  }

  async addTodo() {
    const input = document.querySelector('input');
    const text = input.value.trim();
    
    if (text) {
      await this.todoService.addTodo(text);
      input.value = '';
      this.renderTodos();
    }
  }

  async toggleTodo(id) {
    await this.todoService.toggleTodo(id);
    this.renderTodos();
  }

  async deleteTodo(id) {
    await this.todoService.deleteTodo(id);
    this.renderTodos();
  }

  renderTodos() {
    const todoList = document.getElementById('todoList');
    todoList.innerHTML = this.todoService.todos.map(todo => \`
      <div class="todo-item \${todo.completed ? 'completed' : ''}">
        <input type="checkbox" \${todo.completed ? 'checked' : ''} 
               onchange="app.toggleTodo(\${todo.id})">
        <span class="todo-text">\${todo.text}</span>
        <span class="platform-badge">\${todo.platform}</span>
        <button onclick="app.deleteTodo(\${todo.id})" class="delete-btn">Ã—</button>
      </div>
    \`).join('');
  }

  setupEventListeners() {
    // Platform-specific event handling
    if (this.todoService.platform === 'web') {
      document.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          this.addTodo();
        }
      });
    }
  }
}

// Initialize cross-platform app
const crossPlatformApp = new CrossPlatformApp();"></textarea>
                        </div>
                    </div>
                    <div class="output-panel" id="output5">
                        <div class="output-header">
                            <span>Cross-Platform Status</span>
                            <div class="metrics">
                                <span class="metric">Platform: <span id="crossPlatform">Web</span></span>
                                <span class="metric">Features: <span id="crossFeatures">0</span></span>
                                <span class="metric">Compatibility: <span id="crossCompatibility">100%</span></span>
                            </div>
                        </div>
                        <div class="output-content" id="outputContent5"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="level-actions">
            <button class="btn-secondary" onclick="resetLevel()">
                <i class="fas fa-redo"></i> Reset Level
            </button>
            <button class="btn-primary" onclick="completeLevel()" id="completeBtn" disabled>
                <i class="fas fa-check"></i> Complete Level
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="level22-script.js"></script>
</body>
</html>
